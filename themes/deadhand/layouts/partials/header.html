<header class="header">
	{{ if not .IsHome }}
		<a href="/" class="header__title">Tyler Smith</a>
	{{ end }}
	<ul class="header__menu">
		{{- $currentPage := . -}}
		{{- range .Site.Menus.main -}}
			{{- $currentMenuItem := . -}}
			{{- $isDraft := false -}}
			{{- $path := .URL | relURL | plainify -}}
			{{- $pathNoTrailingSlash := strings.TrimSuffix "/" $path -}}

			{{/* 
				Here we enter the scope of the current page to see if the page
				is in draft. If it is, it will only be shown on the hugo server
				and not on the live site.

			 */}}
			{{- with $.Site.GetPage $pathNoTrailingSlash -}}
				{{- if or (and (not .Draft) (not (.Param "hidden"))) (.Site.IsServer) -}}
					{{/* 
						Grab the length of menu item, get a substring of the 
						current page url the length of the menu item and see if
						they're the same. If they are, it means that the
						current page is a child or the same page and should be active.
					 */}}
					{{- $menuItemUrlLength := len $currentMenuItem.URL -}}
					{{- $pageSubstr := substr $currentPage.URL 0 $menuItemUrlLength -}}
					<li class="header__menu-item">
						<a href="{{ $currentMenuItem.URL }}" class="header__menu-item-link{{ if eq $pageSubstr .URL }} header__menu-item-link--is-active{{end}}">{{ $currentMenuItem.Name }}</a>
					</li>
				{{- end -}}
			{{- else -}}
				<li class="header__menu-item">
					<a href="{{ $currentMenuItem.URL }}" class="header__menu-item-link">{{ $currentMenuItem.Name }}</a>
				</li>
			{{- end -}}
		{{- end -}}	
	</ul>
</header>